<!DOCTYPE html>
<html>
<head>
    <title>Ajax Demo</title>
    <script>
        let ajaxRequest;

        // Hàm tạo đối tượng XMLHttpRequest
        function getXMLHttpRequest() {
            return new XMLHttpRequest();
        }

        // Hàm xử lý khi trạng thái request thay đổi
        function ajaxResponse() {
            if (ajaxRequest.readyState != 4) return;

            if (ajaxRequest.status == 200) { // Kiểm tra nếu thành công
                document.querySelector("#showtime").innerHTML = ajaxRequest.responseText;
            } else {
                alert("Request failed: " + ajaxRequest.statusText);
            }
        }

        // Hàm gọi tới server để cập nhật thời gian
        function getServerTime() {
            ajaxRequest = getXMLHttpRequest();
            if (!ajaxRequest) {
                document.getElementById("showtime").innerHTML = "Request error!";
                return;
            }

            let myURL = "telltime.php";
            let myRand = parseInt(Math.random() * 999999999999999);
            myURL += "?rand=" + myRand;

            ajaxRequest.onreadystatechange = ajaxResponse;
            ajaxRequest.open("GET", myURL);
            ajaxRequest.send(null);
        }
    </script>
</head>
<body onload="getServerTime();">
    <h1>Ajax Demonstration</h1>
    <h2>Getting the server time without refreshing the page</h2>
    <form>
        <input type="button" value="Get Server Time" onclick="getServerTime();" />
    </form>
    <div id="showtime" class="displaybox"></div>
</body>
</html>
